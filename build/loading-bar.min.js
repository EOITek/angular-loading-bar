/*! 
 * angular-loading-bar v0.9.0
 * https://chieffancypants.github.io/angular-loading-bar
 * Copyright (c) 2018 Wes Cruver
 * License: MIT
 */

!function(){"use strict";angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]),angular.module("chieffancypants.loadingBar",["cfp.loadingBarInterceptor"]),angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(c){var e=["$q","$cacheFactory","$log","cfpLoadingBar",function(n,i,t,a){function r(e){var n,t=i.get("$http"),a=c.defaults;!e.cache&&!a.cache||!1===e.cache||"GET"!==e.method&&"JSONP"!==e.method||(n=angular.isObject(e.cache)?e.cache:angular.isObject(a.cache)?a.cache:t);var r=void 0!==n&&void 0!==n.get(e.url);return void 0!==e.cached&&r!==e.cached?e.cached:e.cached=r}return{request:function(e){return e.ignoreLoadingBar||r(e)||a.push({url:e.url}),e},response:function(e){return e&&e.config?e.config.ignoreLoadingBar||r(e.config)||a.pop({url:e.config.url,result:e}):t.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),e},responseError:function(e){return e&&e.config?e.config.ignoreLoadingBar||r(e.config)||a.pop({url:e.config.url,result:e}):t.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),n.reject(e)}}}];c.interceptors.push(e)}]),angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){this.autoIncrement=!0,this.includeSpinner=!0,this.includeBar=!0,this.latencyThreshold=100,this.startSize=.02,this.parentSelector="body",this.spinnerTemplate='<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.$get=["$injector","$document","$timeout","$rootScope",function(r,i,c,o){var l,t,d,n,u=this.parentSelector,s=angular.element(this.loadingBarTemplate),a=s.find("div").eq(0),h=angular.element(this.spinnerTemplate),p=!1,g=0,f=this.autoIncrement,m=this.includeSpinner,v=this.includeBar,B=this.startSize,b=0,S=0,$=this.latencyThreshold;function y(){if(l||(l=r.get("$animate")),c.cancel(d),!p){var e=i[0],n=e.querySelector?e.querySelector(u):i.find(u)[0];n||(n=e.getElementsByTagName("body")[0]);var t=angular.element(n),a=n.lastChild&&angular.element(n.lastChild);o.$broadcast("cfpLoadingBar:started"),p=!0,v&&l.enter(s,t,a),m&&l.enter(h,t,v?s:a),T(B)}}function T(e){if(p){var n=100*e+"%";a.css("width",n),g=e,f&&(c.cancel(t),t=c(function(){L()},250))}}function L(){if(!(1<=j())){var e=0,n=j();e=0<=n&&n<.25?(3*Math.random()+3)/100:.25<=n&&n<.65?3*Math.random()/100:.65<=n&&n<.9?2*Math.random()/100:.9<=n&&n<.99?.005:0,T(j()+e)}}function j(){return g}function I(){g=0,p=!1}function q(){l||(l=r.get("$animate")),T(1),c.cancel(d),d=c(function(){var e=l.leave(s,I);e&&e.then&&e.then(I),l.leave(h),o.$broadcast("cfpLoadingBar:completed")},500)}return{start:y,set:T,status:j,inc:L,complete:q,push:function(e){o.$broadcast("cfpLoadingBar:loading",e),0===b&&($?n=c(function(){y()},$):y()),T(S/++b)},pop:function(e){b<=++S?(o.$broadcast("cfpLoadingBar:loaded",e),c.cancel(n),q(),b=S=0):T(S/b)},autoIncrement:this.autoIncrement,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]})}();